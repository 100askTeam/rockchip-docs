"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[3751],{4969:(n,e,i)=>{i.r(e),i.d(e,{assets:()=>o,contentTitle:()=>s,default:()=>h,frontMatter:()=>l,metadata:()=>p,toc:()=>d});var c=i(5893),r=i(1151);const l={sidebar_position:6},s="Pinctrl\u5f00\u53d1\u6307\u5357",p={id:"Dshanpi-R1-Docs/part5/PinctrlDrive",title:"Pinctrl\u5f00\u53d1\u6307\u5357",description:"1. \u5f15\u811a\u547d\u540d\u89c4\u5219",source:"@site/docs/Dshanpi-R1-Docs/part5/06-PinctrlDrive.md",sourceDirName:"Dshanpi-R1-Docs/part5",slug:"/Dshanpi-R1-Docs/part5/PinctrlDrive",permalink:"/en/docs/Dshanpi-R1-Docs/part5/PinctrlDrive",draft:!1,unlisted:!1,editUrl:"https://github.com/100askTeam/linuxboard-docs/tree/main/docs/Dshanpi-R1-Docs/part5/06-PinctrlDrive.md",tags:[],version:"current",sidebarPosition:6,frontMatter:{sidebar_position:6},sidebar:"rk3568Sidebar",previous:{title:"Can FD\u5f00\u53d1\u6307\u5357",permalink:"/en/docs/Dshanpi-R1-Docs/part5/CanFdDrive"},next:{title:"I2C \u5f00\u53d1\u6307\u5357",permalink:"/en/docs/Dshanpi-R1-Docs/part5/I2cDrive"}},o={},d=[{value:"1. \u5f15\u811a\u547d\u540d\u89c4\u5219",id:"1-\u5f15\u811a\u547d\u540d\u89c4\u5219",level:2},{value:"1.1 GPIO\uff08\u901a\u2f64\u8f93\u2f0a\u8f93\u51fa\uff09",id:"11-gpio\u901a\u8f93\u8f93\u51fa",level:2},{value:"1.2 IOMUX\uff08\u8f93\u2f0a\u8f93\u51fa\u590d\u2f64\uff09",id:"12-iomux\u8f93\u8f93\u51fa\u590d",level:2},{value:"1.3 PULL\uff08\u7aef\u53e3\u4e0a\u4e0b\u62c9\uff09",id:"13-pull\u7aef\u53e3\u4e0a\u4e0b\u62c9",level:2},{value:"1.4 DRIVE-STRENGTH\uff08\u7aef\u53e3\u9a71\u52a8\u5f3a\u5ea6\uff09",id:"14-drive-strength\u7aef\u53e3\u9a71\u52a8\u5f3a\u5ea6",level:2},{value:"1.5 SMT\uff08\u7aef\u53e3\u65af\u5bc6\u7279\u89e6\u53d1\u5668\uff09",id:"15-smt\u7aef\u53e3\u65af\u5bc6\u7279\u89e6\u53d1\u5668",level:2},{value:"2.1 pinctrl-rockchip",id:"21-pinctrl-rockchip",level:2},{value:"2.2 gpio-rockchip",id:"22-gpio-rockchip",level:2},{value:"3.1 \u65b0\u5efapinctrl",id:"31-\u65b0\u5efapinctrl",level:2},{value:"3.2 \u5f15\u7528pinctrl",id:"32-\u5f15\u7528pinctrl",level:2},{value:"4.1 \u7528\u6237\u5c42\u914d\u7f6eIOMUX",id:"41-\u7528\u6237\u5c42\u914d\u7f6eiomux",level:2},{value:"4.2 \u914d\u7f6e\u67d0\u4e2aGPIO\u7535\u5e73",id:"42-\u914d\u7f6e\u67d0\u4e2agpio\u7535\u5e73",level:2},{value:"4.3 \u6a21\u5757\u7684pinctrl-0\u4e0d\u751f\u6548",id:"43-\u6a21\u5757\u7684pinctrl-0\u4e0d\u751f\u6548",level:2}];function t(n){const e={blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",ul:"ul",...(0,r.a)(),...n.components};return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(e.h1,{id:"pinctrl\u5f00\u53d1\u6307\u5357",children:"Pinctrl\u5f00\u53d1\u6307\u5357"}),"\n",(0,c.jsx)(e.h2,{id:"1-\u5f15\u811a\u547d\u540d\u89c4\u5219",children:"1. \u5f15\u811a\u547d\u540d\u89c4\u5219"}),"\n",(0,c.jsx)(e.p,{children:"Rockchip Pin\u7684ID\u6309\u7167 \u63a7\u5236\u5668(bank)+\u7aef\u53e3(port)+\u7d22\u5f15\u5e8f\u53f7(pin) \u7ec4\u6210\u3002"}),"\n",(0,c.jsx)(e.h2,{id:"11-gpio\u901a\u8f93\u8f93\u51fa",children:"1.1 GPIO\uff08\u901a\u2f64\u8f93\u2f0a\u8f93\u51fa\uff09"}),"\n",(0,c.jsxs)(e.ul,{children:["\n",(0,c.jsx)(e.li,{children:"\u63a7\u5236\u5668\u548cGPIO\u63a7\u5236\u5668\u6570\u91cf\u2f00\u81f4"}),"\n",(0,c.jsx)(e.li,{children:"\u7aef\u53e3\u56fa\u5b9a A\u3001B\u3001C\u548cD"}),"\n",(0,c.jsx)(e.li,{children:"\u7d22\u5f15\u5e8f\u53f7\u56fa\u5b9a 0\u30011\u30012\u30013\u30014\u30015\u30016\u30017"}),"\n"]}),"\n",(0,c.jsx)(e.p,{children:"\u4e3e\u4f8bRK3588\uff0c\u4eceRK3588-TRM.pdf\u7684Chapter 20 GPIO\u7ae0\u8282\u770b\u5230"}),"\n",(0,c.jsxs)(e.blockquote,{children:["\n",(0,c.jsx)(e.p,{children:"There are five GPIOs (GPIO0 in PD_PMU,GPIO1/GPIO2/GPIO3/GPIO4 in PD_BUS)"}),"\n"]}),"\n",(0,c.jsx)(e.p,{children:"\u67095\u4e2aGPIO\u63a7\u5236\u5668\uff0c\u6bcf\u4e2a\u63a7\u5236\u5668\u53ef\u4ee5\u63a7\u523632\u4e2aIO\uff0c\u4f5c\u4e3aGPIO\u529f\u80fd\u65f6\uff0c\u7aef\u53e3\u2f8f\u4e3a\u7531GPIO\u63a7\u5236\u5668\u5bc4\u5b58\u5668\u914d\n\u7f6e\u3002"}),"\n",(0,c.jsx)(e.h2,{id:"12-iomux\u8f93\u8f93\u51fa\u590d",children:"1.2 IOMUX\uff08\u8f93\u2f0a\u8f93\u51fa\u590d\u2f64\uff09"}),"\n",(0,c.jsx)(e.p,{children:"Rockchip Pin\u53ef\u4ee5\u590d\u2f64\u6210\u591a\u79cd\u529f\u80fd\uff0c\u540c\u2f00\u4e2a\u63a7\u5236\u5668\u5982\u679c\u5b58\u5728\u591a\u79cd\u590d\u2f64\u5f15\u811a\uff0c\u2f00\u822c\u53eb\u505am0\u3001m1\u3001m2\u7b49\u7b49\uff0c\u5982I2C\u63a7\u5236\u5668\u6709\u4e24\u7ec4\u590d\u2f64\u5f15\u811a\uff0c\u5206\u522b\u662f2cm0\u3001i2cm1\u3002"}),"\n",(0,c.jsx)(e.p,{children:"\u5f15\u811a\u590d\u2f64\u914d\u7f6e\u7684\u5bc4\u5b58\u5668\u662f\u5728GRF/PMUGRF\uff08RK3588\u53eb\u505aIOC\uff09\u3002"}),"\n",(0,c.jsx)(e.p,{children:"\u4e3e\u4f8bRK3588 BUS_IOC_GPIO1B_IOMUX_SEL_H Address: Operational Base + offset(0x002C)"}),"\n",(0,c.jsxs)(e.blockquote,{children:["\n",(0,c.jsx)(e.p,{children:"gpio1b7_sel\n4'h0: GPIO\n4'h2: MIPI_CAMERA2_CLK_M0\n4'h3: SPDIF1_TX_M0\n4'h4: PCIE30X2_PERSTN_M3\n4'h5: HDMI_RX_CEC_M2\n4'h6: SATA2_ACT_LED_M1\n4'h9: I2C5_SDA_M3\n4'ha: UART1_RX_M1\n4'hb: PWM13_M2"}),"\n"]}),"\n",(0,c.jsx)(e.p,{children:"\u5982\u4e0b\u662fRK3588 I2C5\u7684IOMUX\uff1a"}),"\n",(0,c.jsx)(e.p,{children:(0,c.jsx)(e.img,{alt:"1",src:i(2403).Z+"",width:"691",height:"547"})}),"\n",(0,c.jsx)(e.p,{children:"\u591a\u901a\u8def\u590d\u2f64\u2f40\u6301\u786c\u4ef6\u8bbe\u8ba1\u66f4\u4e3a\u7075\u6d3b\uff0c\u5f53\u5916\u8bbe\u2f2f\u4f5c\u7535\u538b\u662f1.8V\u62163.3V\uff0c\u53ef\u4ee5\u9009\u62e9\u4e0d\u540c\u7535\u538b\u57dfVCCIO\u7684\u5f15\u811a\u3002"}),"\n",(0,c.jsx)(e.p,{children:"\u6ce8\u610f\uff1a\u591a\u901a\u8def\u590d\u2f64\u7684\u5bc4\u5b58\u5668\u914d\u7f6e\uff0c\u5bf9TX\u7c7b\u7684\u5f15\u811a\u6ca1\u6709\u2f64\uff0c\u5bf9RX\u7c7b\u7684\u5f15\u811a\u8d77\u4f5c\u2f64\u3002"}),"\n",(0,c.jsx)(e.h2,{id:"13-pull\u7aef\u53e3\u4e0a\u4e0b\u62c9",children:"1.3 PULL\uff08\u7aef\u53e3\u4e0a\u4e0b\u62c9\uff09"}),"\n",(0,c.jsx)(e.p,{children:"Rockchip IO PAD\u7684bias\u2f00\u822c\u2f40\u63013\u79cd\u6a21\u5f0f"}),"\n",(0,c.jsxs)(e.ul,{children:["\n",(0,c.jsx)(e.li,{children:"bias-disable"}),"\n",(0,c.jsx)(e.li,{children:"bias-pull-up"}),"\n",(0,c.jsx)(e.li,{children:"bias-pull-down"}),"\n"]}),"\n",(0,c.jsx)(e.p,{children:"\u4e0a\u4e0b\u62c9\u914d\u7f6e\u662f\u4f5c\u2f64\u4e8eIO PAD\uff0c\u914d\u7f6e\u5bf9GPIO/IOMUX\u90fd\u8d77\u4f5c\u2f64\u3002"}),"\n",(0,c.jsx)(e.h2,{id:"14-drive-strength\u7aef\u53e3\u9a71\u52a8\u5f3a\u5ea6",children:"1.4 DRIVE-STRENGTH\uff08\u7aef\u53e3\u9a71\u52a8\u5f3a\u5ea6\uff09"}),"\n",(0,c.jsx)(e.p,{children:"Rockchip IO PAD\u7684\u9a71\u52a8\u5f3a\u5ea6\uff0c\u6839\u636e\u4e0d\u540c\u2f2f\u827a\uff0c\u2f40\u6301\u4e0d\u540c\u5f3a\u5ea6\u914d\u7f6e\uff1bRK3399\u4e4b\u524d\u7684\u82af\u2f5a\uff0c\u9a71\u52a8\u5f3a\u5ea6\u914d\u7f6e\u6309mA\u4e3a\u5355\u4f4d\u914d\u7f6e\uff0cRK1808\u4e4b\u540e\u82af\u2f5a\uff0c\u2f00\u822c\u6309\u7167Level\u4e3a\u5355\u4f4d\uff0c\u6863\u4f4d\u7684\u6570\u503c\u5373\u4e3a\u5bc4\u5b58\u5668\u914d\u7f6e\u503c\u3002"}),"\n",(0,c.jsx)(e.p,{children:"\u4e3e\u4f8bRK3588 TRM\u4e2dGPIO0_C7\u7684\u9a71\u52a8\u5f3a\u5ea6\u7b49\u7ea7\u5982\u4e0b\uff1a"}),"\n",(0,c.jsxs)(e.blockquote,{children:["\n",(0,c.jsx)(e.p,{children:"gpio0c7_ds\nGPIO0C7 DS control Driver Strength Selection\n3'b000: 100ohm\n3'b100: 66ohm 3'b010: 50ohm\n3'b110: 40ohm 3'b001: 33ohm 3'b101: 25ohm"}),"\n"]}),"\n",(0,c.jsx)(e.p,{children:"\u8f6f\u4ef6\u9a71\u52a8\u4f9d\u7136\u6309\u7167Level\u6765\u5904\u7406\uff0c\u5373\u4e0a\u8ff0\u5bc4\u5b58\u5668\u63cf\u8ff0\u5bf9\u5e94\uff1a"}),"\n",(0,c.jsxs)(e.blockquote,{children:["\n",(0,c.jsxs)(e.p,{children:["3'b000: Level0\n3'b100: Level4\n3'b010: Level2\n3'b110: Level6\n3'b001",":Level1","\n3'b101: Level5"]}),"\n"]}),"\n",(0,c.jsxs)(e.p,{children:["DTS\u4e2d ",(0,c.jsx)(e.code,{children:"drive-strength=<5>"}),"; \u8868\u2f70\u914d\u7f6e\u4e3aLevel5\uff0c\u5373\u5bc4\u5b58\u5668\u5199 ",(0,c.jsx)(e.code,{children:"3'b101"})]}),"\n",(0,c.jsx)(e.h2,{id:"15-smt\u7aef\u53e3\u65af\u5bc6\u7279\u89e6\u53d1\u5668",children:"1.5 SMT\uff08\u7aef\u53e3\u65af\u5bc6\u7279\u89e6\u53d1\u5668\uff09"}),"\n",(0,c.jsx)(e.p,{children:"Rockchip IO PAD\u2f24\u591a\u6570\u82af\u2f5a\u2f40\u6301SMT\u529f\u80fd\uff0c\u9ed8\u8ba4\u4e0d\u4f7f\u80fd\uff1b\u4f7f\u80fdSMT\u53ef\u4ee5\u6d88\u9664\u8fb9\u6cbf\u6296\u52a8\uff0c\u52a0\u2f24VIH VIL\u7684 \u7535\u538b\u533a\u95f4\uff0c\u589e\u5f3aIO\u7684\u4fe1\u53f7\u7a33\u5b9a\u6027\u3002\u2f00\u822cI2C\u7684SCL/SDA\u4f1a\u9ed8\u8ba4\u4f7f\u80fdSMT\u529f\u80fd\u3002"}),"\n",(0,c.jsx)(e.h1,{id:"2-\u9a71\u52a8\u4ecb\u7ecd",children:"2. \u9a71\u52a8\u4ecb\u7ecd"}),"\n",(0,c.jsxs)(e.p,{children:["Rockchip pinctrl\u9a71\u52a8\u5305\u62ecPinctrl\u9a71\u52a8\uff08",(0,c.jsx)(e.code,{children:"drivers/pinctrl/pinctrl-rockchip.c"}),"\uff09 \u548c GPIO\u9a71\u52a8 \uff08",(0,c.jsx)(e.code,{children:"drivers/gpio/gpio-rockchip.c"}),"\uff09\u3002"]}),"\n",(0,c.jsx)(e.p,{children:"Pinctrl\u9a71\u52a8\u662f\u4e3b\u8981\u9a71\u52a8\uff0c\u63d0\u4f9bIO\u7684\u2f45\u6cd5\u96c6\uff0c\u5305\u62ecPINMUX\u3001PINCONF \u548c GPIO\u3002"}),"\n",(0,c.jsx)(e.p,{children:"GPIO\u9a71\u52a8\u662f\u5b8c\u6210 gpiochip \u7684\u529f\u80fd\uff0c\u5305\u62ec GPIO \u548c IRQ\u3002"}),"\n",(0,c.jsx)(e.h2,{id:"21-pinctrl-rockchip",children:"2.1 pinctrl-rockchip"}),"\n",(0,c.jsx)(e.p,{children:"//TO-DO"}),"\n",(0,c.jsx)(e.h2,{id:"22-gpio-rockchip",children:"2.2 gpio-rockchip"}),"\n",(0,c.jsx)(e.p,{children:"//TO-DO"}),"\n",(0,c.jsx)(e.h1,{id:"3-dts\u4ecb\u7ecd",children:"3. DTS\u4ecb\u7ecd"}),"\n",(0,c.jsx)(e.p,{children:"Rockchip dts\u2f00\u822c\u628apinctrl\u8282\u70b9\u653e\u5728soc.dtsi\uff0c\u4f8b\u5982rk3588s.dtsi\uff0c\u2f00\u822c\u4f4d\u4e8e\u6700\u540e\u2f00\u4e2a\u8282\u70b9\u3002"}),"\n",(0,c.jsxs)(e.p,{children:["pinctrl\u8282\u70b9\u6ca1\u6709reg\uff0c\u5b83\u4e0d\u662f\u2f00\u4e2a\u6807\u51c6platform device\uff0c\u5bc4\u5b58\u5668\u57fa\u5730\u503c\u662f\u901a\u8fc7",(0,c.jsx)(e.code,{children:"rockchip,grf=<&grf>"}),"; \u4f20\u2f0a\uff1b\u9a71\u52a8\u5185\u90e8\u6839\u636e\u8fd9\u4e2a\u57fa\u5730\u503c\uff0c\u52a0\u504f\u79fb\u5730\u5740\uff0c\u5b8c\u6210IOMUX\u3001PINCONF\u7684\u914d\u7f6e\uff1bGPIO\u662f\u4f7f\u2f64gpio\u8282\u70b9\u7684reg\u5730\u5740\u3002"]}),"\n",(0,c.jsx)(e.p,{children:"\u4e3e\u4f8b arch/arm64/boot/dts/rockchip/rk3588s.dtsi"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-bash",children:'{\n    pinctrl: pinctrl {\n        compatible = "rockchip,rk3588-pinctrl"; \n        rockchip,grf = <&ioc>;\n        #address-cells = <2>; \n        #size-cells = <2>; \n        ranges;\n    \n        gpio0: gpio@fd8a0000 {\n            compatible = "rockchip,gpio-bank"; \n            reg = <0x0 0xfd8a0000 0x0 0x100>;\n            interrupts = <GIC_SPI 277 IRQ_TYPE_LEVEL_HIGH>; \n            clocks = <&cruPCLK_GPIO0>, <&cru DBCLK_GPIO0>;\n            gpio-controller; \n            #gpio-cells = <2>; \n            interrupt-controller;\n            #interrupt-cells = <2>; \n        };\n        \n        gpio1: gpio@fec20000 {\n            compatible = "rockchip,gpio-bank";\n            reg = <0x0 0xfec20000 0x0 0x100>;\n            interrupts = <GIC_SPI 278 IRQ_TYPE_LEVEL_HIGH>;\n            clocks = <&cruPCLK_GPIO1>, <&cru DBCLK_GPIO1>;\n            gpio-controller; \n            #gpio-cells = <2>; \n            interrupt-controller;\n            #interrupt-cells = <2>; \n        };\n        \n        gpio2: gpio@fec30000 {\n            compatible = "rockchip,gpio-bank"; \n            reg = <0x0 0xfec30000 0x0 0x100>;\n            interrupts = <GIC_SPI 279 IRQ_TYPE_LEVEL_HIGH>; \n            clocks = <&cruPCLK_GPIO2>, <&cru DBCLK_GPIO2>;\n            gpio-controller; \n            #gpio-cells = <2>; \n            interrupt-controller;\n            #interrupt-cells = <2>; \n        };\n        \n        gpio3: gpio@fec40000 {\n            compatible = "rockchip,gpio-bank"; \n            reg = <0x0 0xfec40000 0x0 0x100>;\n            interrupts = <GIC_SPI 280 IRQ_TYPE_LEVEL_HIGH>; \n            clocks = <&cruPCLK_GPIO3>, <&cru DBCLK_GPIO3>;\n            gpio-controller; \n            #gpio-cells = <2>; \n            interrupt-controller;\n            #interrupt-cells = <2>; \n        };\n        \n        gpio4: gpio@fec50000 {\n            compatible = "rockchip,gpio-bank"; reg = <0x0 0xfec50000 0x0 0x100>;\n            interrupts = <GIC_SPI 281 IRQ_TYPE_LEVEL_HIGH>; \n            clocks = <&cruPCLK_GPIO4>, <&cru DBCLK_GPIO4>;\n            gpio-controller;\n            #gpio-cells = <2>; \n            interrupt-controller;\n            #interrupt-cells = <2>; \n        }; \n    }; \n};\n'})}),"\n",(0,c.jsx)(e.p,{children:"\u8fd8\u6709 arch/arm64/boot/dts/rockchip/rk3588s-pinctrl.dtsi\u2f42\u4ef6\u901a\u8fc7include\u5f62\u5f0f\u52a0\u5230rk3588s.dtsi\u3002"}),"\n",(0,c.jsx)(e.h2,{id:"31-\u65b0\u5efapinctrl",children:"3.1 \u65b0\u5efapinctrl"}),"\n",(0,c.jsx)(e.p,{children:"rk3588s-pinctrl.dtsi\u2f42\u4ef6\u5df2\u7ecf\u679a\u4e3e\u4e86rk3588s\u82af\u2f5a\u6240\u6709iomux\u7684\u5b9e\u4f8b\uff0c\u5404\u6a21\u5757\u2f00\u822c\u4e0d\u518d\u9700\u8981\u521b\u5efaiomux\u5b9e\u4f8b\u3002"}),"\n",(0,c.jsx)(e.p,{children:"\u521b\u5efaiomux\u5b9e\u4f8b\u9700\u8981\u9075\u5faa\u5982\u4e0b\u89c4\u5219\uff1a"}),"\n",(0,c.jsxs)(e.ol,{children:["\n",(0,c.jsxs)(e.li,{children:["\n",(0,c.jsx)(e.p,{children:"\u5fc5\u987b\u5728pinctrl\u8282\u70b9\u4e0b"}),"\n"]}),"\n",(0,c.jsxs)(e.li,{children:["\n",(0,c.jsx)(e.p,{children:"\u5fc5\u987b\u4ee5function+group\u7684\u5f62\u5f0f\u6dfb\u52a0"}),"\n"]}),"\n",(0,c.jsxs)(e.li,{children:["\n",(0,c.jsx)(e.p,{children:"function+group\u7684\u683c\u5f0f\u5982\u4e0b"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-c",children:"function { \n    group {\n        rockchip,pin = <bank gpio func &ref>;\n    };\n};\n"})}),"\n"]}),"\n",(0,c.jsxs)(e.li,{children:["\n",(0,c.jsx)(e.p,{children:"\u9075\u5faa\u5176\u4ed6dts\u7684\u57fa\u672c\u89c4\u5219"}),"\n"]}),"\n"]}),"\n",(0,c.jsx)(e.h2,{id:"32-\u5f15\u7528pinctrl",children:"3.2 \u5f15\u7528pinctrl"}),"\n",(0,c.jsx)(e.p,{children:"\u6a21\u5757\u5f15\u2f64pinctrl\u662f\u901a\u8fc7 pinctrl-names \u548c pinctrl-0\u8fde\u63a5\u6a21\u5757\u548cpinctrl\u9a71\u52a8\u3002"}),"\n",(0,c.jsx)(e.p,{children:"\u4e3e\u4f8b rk3588 uart2\uff1a"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-bash",children:'{\n    uart2: serial@feb50000 {\n        compatible = "rockchip,rk3588-uart", "snps,dw-apb-uart";\n        reg = <0x00xfeb50000 0x0 0x100>;\n        interrupts = <GIC_SPI 333 IRQ_TYPE_LEVEL_HIGH>;\n        clocks = <&cruSCLK_UART2>, <&cru PCLK_UART2>;\n        clock-names = "baudclk","apb_pclk";\n        reg-shift = <2>;\n        reg-io-width = <4>;\n        dmas = <&dmac0 10>, <&dmac0 11>;\n        pinctrl-names = "default";\n        pinctrl-0 = <&uart2m1_xfer>; \n        status = "disabled";\n    }; \n};\n'})}),"\n",(0,c.jsxs)(e.p,{children:[(0,c.jsx)(e.code,{children:"uart2m1_xfer"}),"\u662f\u2f00\u4e2apinctrl group\uff1b\u6a21\u5757\u53ef\u4ee5\u540c\u65f6\u5f15\u2f64\u591a\u7ec4group."]}),"\n",(0,c.jsx)(e.p,{children:"\u4e3e\u4f8b rk3588 pdm1\uff1a"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-bash",children:'{\n    pdm1: pdm@fe4c0000 {\n        compatible = "rockchip,rk3588-pdm";\n        reg = <0x0 0xfe4c0000 0x00x1000>;\n        clocks = <&cru MCLK_PDM1>, <&cru HCLK_PDM1>;\n        clock-names = "pdm_clk", "pdm_hclk";\n        assigned-clocks = <&cru MCLK_PDM1>;\n        assigned-clock-parents = <&cru PLL_AUPLL>; \n        dmas = <&dmac1 4>;\n        dma-names = "rx";\n        power-domains = <&power RK3588_PD_AUDIO>;\n        pinctrl-names = "default";\n        pinctrl-0 = <&pdm1m0_clk &pdm1m0_clk1 &pdm1m0_sdi0 &pdm1m0_sdi1 &pdm1m0_sdi2 &pdm1m0_sdi3>;\n        /* \u7b49\u540c\u4e8e\u5982\u4e0b\u5199\u6cd5 */ \n        /*\n        * pinctrl-0 = <&pdm1m0_clk>, \n        * <&pdm1m0_clk1>, \n        * <&pdm1m0_sdi0>, \n        * <&pdm1m0_sdi1>, \n        * <&pdm1m0_sdi2>,\n        * <&pdm1m0_sdi3>; \n        */\n        #sound-dai-cells = <0>; \n        status = "disabled";\n    }; \n};\n'})}),"\n",(0,c.jsx)(e.p,{children:"pinctrl-names\u53ef\u4ee5\u2f40\u6301\u591a\u4e2a\u5b9e\u4f8b\uff0cpinctrl \u9ed8\u8ba4\u7684\u67094\u79cd\u5b9e\u4f8b\uff08state\uff09\uff1a"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-bash",children:'#define PINCTRL_STATE_DEFAULT "default"\n#define PINCTRL_STATE_INIT    "init" \n#define PINCTRL_STATE_IDLE    "idle" \n#define PINCTRL_STATE_SLEEP   "sleep"\n'})}),"\n",(0,c.jsx)(e.p,{children:'"init" \u5728driver probe\u671f\u95f4\u2f63\u6548\uff0cprobe done\u4e4b\u540e\u53ef\u80fd\u4f1a\u5207\u6362\u56de"default"\uff08\u5982\u679cprobe\u4e2d\u5207\u6362\u5230\u5176\u4ed6state\uff0c\u5c31 \u4e0d\u4f1a\u5207\u6362\u56de "init"\uff09\u3002'}),"\n",(0,c.jsxs)(e.p,{children:[(0,c.jsx)(e.code,{children:"pinctrl-names"})," \u662f\u53ef\u4ee5\u2f83\u5b9a\u4e49\u7684\uff0c\u6709driver\u53bb\u5339\u914d\u89e3\u6790\u3002"]}),"\n",(0,c.jsx)(e.p,{children:"\u4e3e\u4f8b rk3588 pwm4\uff1a"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-bash",children:'{\n    pwm4: pwm@febd0000 {\n        compatible = "rockchip,rk3588-pwm", "rockchip,rk3328-pwm";\n        reg = <0x00xfebd0000 0x0 0x10>;\n        #pwm-cells = <3>;\n        pinctrl-names = "active";\n        pinctrl-0 = <&pwm4m0_pins>;\n        clocks = <&cru CLK_PWM1>, <&cru PCLK_PWM1>;\n        clock-names = "pwm","pclk";\n        status = "disabled"; \n    };\n};\n'})}),"\n",(0,c.jsx)(e.h1,{id:"4-faq",children:"4. FAQ"}),"\n",(0,c.jsx)(e.h2,{id:"41-\u7528\u6237\u5c42\u914d\u7f6eiomux",children:"4.1 \u7528\u6237\u5c42\u914d\u7f6eIOMUX"}),"\n",(0,c.jsx)(e.p,{children:"iomux\u662fgcc\u7f16\u8bd1\u7684\u2f06\u8fdb\u5236\u2f42\u4ef6\uff0c\u901a\u8fc7ioctl\u8c03\u2f64rockchip-pinctrl device\uff0c\u8bbe\u7f6eiomux\uff0c\u4e5f\u53ef\u4ee5\u83b7\u53d6iomux\u5f53\u524d\u503c\u3002"}),"\n",(0,c.jsx)(e.p,{children:"\u7f16\u8bd1\u2f45\u6cd5\uff1a"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-bash",children:"gcc tools/testing/selftests/rkpinctrl/iomux.c -o iomux\n"})}),"\n",(0,c.jsx)(e.p,{children:"\u4f7f\u2f64\u2f45\u6cd5\uff1a"}),"\n",(0,c.jsx)(e.p,{children:"\u4e3e\u4f8b\uff1a\u8bbe\u7f6e GPIO0_B7 \u4e3a func1"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-bash",children:"[root@RK3588:/]# iomux 0 15 1\n"})}),"\n",(0,c.jsx)(e.p,{children:"\u4e3e\u4f8b\uff1a\u83b7\u53d6 GPIO0_B7 \u5f53\u524diomux\u503c"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-bash",children:"[root@RK3588:/]# iomux 0 15 mux get (GPIO0-15) = 1\t\n"})}),"\n",(0,c.jsx)(e.h2,{id:"42-\u914d\u7f6e\u67d0\u4e2agpio\u7535\u5e73",children:"4.2 \u914d\u7f6e\u67d0\u4e2aGPIO\u7535\u5e73"}),"\n",(0,c.jsx)(e.p,{children:"\u6709\u4e2a\u522b\u9700\u6c42\u662f\u67d0\u4e2aGPIO\u4e0d\u5c5e\u4e8e\u67d0\u4e2a\u7279\u5b9a\u6a21\u5757\uff0c\u66f4\u591a\u662f\u67d0\u4e2a\u7535\u6e90\u5f00\u5173\uff0c\u5e0c\u671b\u5728\u7cfb\u7edf\u5f00\u673a\u8fc7\u9519\u5c3d\u5feb\u8f93\u51fa\u2fbc\u6216\n\u4f4e\u7535\u5e73\uff0c\u8981\u600e\u4e48\u5b9e\u73b0\u5462\uff1f"}),"\n",(0,c.jsx)(e.p,{children:'\u4f7f\u2f64"regulator-fixed"'}),"\n",(0,c.jsx)(e.p,{children:"regulator-fixed\u901a\u5e38\u2f64\u4e8e\u5b9a\u4e49\u7535\u538b\u56fa\u5b9a\u7684regulator\uff0c\u6216\u7531\u67d0\u4e2aGPIO\u5f00\u5173\u63a7\u5236\u7684regulator\u3002"}),"\n",(0,c.jsx)(e.p,{children:"/\u4ee5GPIO2_A1\u9700\u8981\u914d\u7f6e\u4e3a\u2fbc\u7535\u5e73\u4e3a\u4f8b"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-bash",children:'/ {\n    foo_name: foo-name {\n        compatible = "regulator-fixed"; \n        pinctrl-names = "default"; \n        pinctrl-0 = <&gpio_foo>; \n        regulator-name = "vcc-foo";\n        regulator-always-on;\n    }; \n};\n\n&pinctrl { \n\tgpio-foo {\n        gpio_foo: gpio-foo {\n            rockchip,pins = <2 RK_PA1 RK_FUNC_GPIO &pcfg_output_high>; \n        };\n    }; \n};\n'})}),"\n",(0,c.jsx)(e.h2,{id:"43-\u6a21\u5757\u7684pinctrl-0\u4e0d\u751f\u6548",children:"4.3 \u6a21\u5757\u7684pinctrl-0\u4e0d\u751f\u6548"}),"\n",(0,c.jsx)(e.p,{children:"\u901a\u5e38\u6a21\u5757\u8c03\u2f64 pinctrl-names pinctrl-0 \u914d\u7f6e\u9ed8\u8ba4\u7684IOMUX\u6216\u5728IOCONFIG\uff0c\u4f46\u4e0d\u662f\u6240\u6709\u7684\u8282\u70b9\u90fd\u53ef\u4ee5\u52a0\u8fd9\u4e24\u4e2a\u5c5e\u6027\uff0c\u5982\u679c\u6a21\u5757\u88ab driver_probe_device \u8c03\u2f64\uff0c\u5b83\u5c31\u53ef\u4ee5\u52a0\u8fd9\u4e24\u4e2a\u5c5e\u6027\u3002"}),"\n",(0,c.jsxs)(e.p,{children:["\u8c03\u8bd5\u2f45\u6cd5\uff1a ",(0,c.jsx)(e.code,{children:"drivers/base/dd.c"})," \u7684pinctrl_bind_pins\uff0c\u5728\u8fd9\u2fa5\u52a0\u6253\u5370\u770b\u8c03\u2f64\u3002"]})]})}function h(n={}){const{wrapper:e}={...(0,r.a)(),...n.components};return e?(0,c.jsx)(e,{...n,children:(0,c.jsx)(t,{...n})}):t(n)}},2403:(n,e,i)=>{i.d(e,{Z:()=>c});const c=i.p+"assets/images/one-9fd2c2b5b2951d90dc5e1a8bd20a1ef3.png"},1151:(n,e,i)=>{i.d(e,{Z:()=>p,a:()=>s});var c=i(7294);const r={},l=c.createContext(r);function s(n){const e=c.useContext(l);return c.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function p(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(r):n.components||r:s(n.components),c.createElement(l.Provider,{value:e},n.children)}}}]);